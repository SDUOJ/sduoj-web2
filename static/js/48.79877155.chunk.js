(this.webpackJsonpsduoj=this.webpackJsonpsduoj||[]).push([[48],{1199:function(e,t,n){"use strict";var r=n(66),i=n(988),a=n(989),s=n(190),c=n(1209),o=n(64),u=n(313),l=n(0),d=n(312),j=n(105),b=n(1386),f=n(6);t.a=Object(d.a)()((function(e){var t=Object(l.useState)(),n=Object(r.a)(t,2),d=n[0],h=n[1],O=function(){j.a.getCaptcha().then((function(t){h(t.captcha),e.setImgId(t.captchaId)}))};Object(l.useEffect)((function(){O()}),[]);var p=Object(f.jsxs)(i.a,{children:[Object(f.jsx)(a.a,{span:14,children:Object(f.jsx)(s.a,{onChange:function(t){void 0!==e.setCaptcha&&e.setCaptcha(t.target.value)}})}),Object(f.jsx)(a.a,{offset:1,span:8,children:Object(f.jsx)(c.a,{src:d,height:32})}),Object(f.jsx)(a.a,{span:1,children:Object(f.jsx)(o.a,{icon:Object(f.jsx)(b.a,{}),onClick:function(){O()}})})]});return Object(f.jsx)(f.Fragment,{children:[""].map((function(){return void 0!==e.setCaptcha?p:Object(f.jsx)(u.a.Item,{name:"captcha",label:e.t("captcha"),rules:[{required:!0}],children:p})}))})}))},1200:function(e,t,n){"use strict";var r=n(313),i=n(190),a=(n(0),n(312)),s=n(105),c=n(6);t.a=Object(a.a)()((function(e){return Object(c.jsx)(r.a.Item,{name:"username",label:e.t("username"),rules:[{required:!1!==e.editable&&!0!==e.notRequired,message:e.t("usernameEmpty")},function(t){t.getFieldValue;return{validator:function(t,n){return!0===e.ExistCheck?s.a.isExist({username:n}).then((function(e){return!1===e?Promise.resolve():!0===e?Promise.reject("\u7528\u6237\u540d\u5df2\u5b58\u5728"):Promise.reject("\u68c0\u9a8c\u5931\u8d25")})).catch((function(e){return Promise.reject(e)})):Promise.resolve()}}}],hasFeedback:!0,children:Object(c.jsx)(i.a,{disabled:!1===e.editable,bordered:e.editable})})}))},1201:function(e,t,n){"use strict";var r=n(66),i=n(313),a=n(190),s=n(984),c=n(101),o=n(64),u=n(0),l=n(312),d=n(105),j=n(1199),b=n(6);t.a=Object(l.a)()((function(e){var t,n=Object(u.useState)(0),l=Object(r.a)(n,2),f=l[0],h=l[1],O=Object(u.useState)(!1),p=Object(r.a)(O,2),m=p[0],x=p[1],v=Object(u.useState)(""),g=Object(r.a)(v,2),y=g[0],k=g[1],P=Object(u.useState)(""),C=Object(r.a)(P,2),I=C[0],E=C[1],F=Object(u.useState)(""),w=Object(r.a)(F,2),S=w[0],V=w[1];return Object(u.useEffect)((function(){var e=setInterval((function(){f>0&&h(f-1)}),1e3);return function(){return clearInterval(e)}})),Object(b.jsxs)(b.Fragment,{children:[!1===e.needVerify&&Object(b.jsx)(i.a.Item,{name:"email",label:e.t("email"),rules:!0!==e.notCheck?[{type:"email",message:e.t("emailError")},{required:!1!==e.editable}]:void 0,hasFeedback:!0,children:Object(b.jsx)(a.a,{disabled:!1===e.editable,bordered:!1!==e.editable})}),!0===e.needVerify&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(s.a,{title:"\u4eba\u673a\u8eab\u4efd\u8ba4\u8bc1",visible:m,maskClosable:!1,destroyOnClose:!0,onOk:function(){d.a.sendVerificationEmail({email:S,captcha:I,captchaId:y,event:e.emailVerifyType}).then((function(e){c.b.success("\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\u81f3\u60a8\u7684\u90ae\u7bb1"),h(60),x(!1)}))},onCancel:function(){x(!1)},children:Object(b.jsx)(j.a,{setImgId:k,setCaptcha:E})}),Object(b.jsx)(i.a.Item,{name:"email",label:null!==(t=e.emailTitle)&&void 0!==t?t:e.t("new email"),rules:[{required:!0},function(t){t.getFieldValue;return{validator:function(t,n){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)?!1===e.checkExist?Promise.resolve():d.a.isExist({email:n}).then((function(t){return!1===t?Promise.resolve():!0===t?Promise.reject(e.t("\u90ae\u7bb1\u5df2\u5b58\u5728")):Promise.reject(e.t("\u68c0\u9a8c\u5931\u8d25"))})).catch((function(e){return Promise.reject(e)})):Promise.reject(e.t("emailError"))}}}],children:Object(b.jsx)(a.a,{disabled:!1===e.editable||f>0,bordered:!1!==e.editable,onPressEnter:e.onPressEnter,addonAfter:Object(b.jsx)(o.a,{type:"text",disabled:0!==f,onClick:function(){e.getEmail().then((function(e){V(e),x(!0)})).catch((function(){c.b.error("\u90ae\u7bb1\u4e0d\u5408\u6cd5")}))},children:0!==f?f+"s":e.t("Verify")})})}),Object(b.jsx)(i.a.Item,{name:"emailCode",label:e.t("emailCode"),rules:[{required:!0}],children:Object(b.jsx)(a.a,{onPressEnter:e.onPressEnter})})]})]})}))},1235:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(103);function i(e){var t={},n=e.indexOf("?"),i=e.substr(n+1);if(-1!==n){var a,s=i.split("&"),c=Object(r.a)(s);try{for(c.s();!(a=c.n()).done;){var o=a.value.split("=");t[o[0]]=o[1]}}catch(u){c.e(u)}finally{c.f()}}return t}},1328:function(e,t,n){"use strict";t.a=n.p+"static/media/sdu-logo.9fcfaf04.jpg"},1419:function(e,t,n){"use strict";n.r(t);var r=n(142),i=n(143),a=n(145),s=n(144),c=n(0),o=n(101),u=n(254),l=n(1209),d=n(991),j=n(981),b=n(64),f=n(71),h=n(312),O=n(43),p=n(1235),m=n(105),x=n(1328),v=n(9),g=n(66),y=n(4),k=n.n(y),P=n(1433),C=n(1200),I=n(272),E=n(1201),F=n(306),w=n(6),S=Object(O.e)((function(e){var t=Object(F.a)(),n=Object(g.a)(t,1)[0];Object(c.useEffect)((function(){void 0!==e.token&&n.setFieldsValue({username:e.username})}),[e,n]);var r=Object(f.c)();return Object(w.jsxs)(P.a,{title:void 0!==e.token?"\u6ce8\u518c\u5e76\u7ed1\u5b9a":"\u7528\u6237\u6ce8\u518c",trigger:e.button,autoFocusFirstInput:!0,modalProps:{maskClosable:!1,destroyOnClose:!0,width:500,okText:"\u63d0\u4ea4"},form:n,onFinish:function(){var t=Object(v.a)(k.a.mark((function t(n){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e.token){t.next=5;break}return Object.assign(n,{token:e.token}),t.abrupt("return",m.a.thirdPartyRegister(n).then((function(e){return r({type:"userLogin"}),r({type:"setUserInfo",data:e}),o.b.success("\u6ce8\u518c\u6210\u529f"),!0})));case 5:return t.abrupt("return",m.a.register(n).then((function(e){return r({type:"userLogin"}),r({type:"setUserInfo",data:e}),o.b.success("\u6ce8\u518c\u6210\u529f"),!0})));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),children:[Object(w.jsx)(C.a,{ExistCheck:!0,editable:void 0===e.token}),Object(w.jsx)(I.a,{}),Object(w.jsx)(E.a,{emailVerifyType:void 0!==e.token?"thirdPartyRegisterOrBinding":"register",needVerify:!0,getEmail:function(){return n.validateFields(["email"]).then((function(e){return Promise.resolve(e.email)})).catch((function(){return Promise.reject()}))}})]})})),V=n(91),A=Object(h.a)()(Object(O.e)((function(e){var t=Object(F.a)(),n=Object(g.a)(t,1)[0],r=Object(f.c)();return Object(w.jsxs)(P.a,{title:"\u7ed1\u5b9a\u5df2\u6709\u8d26\u53f7",trigger:e.button,autoFocusFirstInput:!0,modalProps:{maskClosable:!1,destroyOnClose:!0,width:500,okText:"\u63d0\u4ea4"},form:n,onFinish:function(){var t=Object(v.a)(k.a.mark((function t(n){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Object.assign(n,{token:e.token}),t.abrupt("return",m.a.thirdPartyBinding(n).then((function(t){return r({type:"userLogin"}),r({type:"setUserInfo",data:t}),e.history.push(V.g+"/home"),o.b.success("\u7ed1\u5b9a\u6210\u529f"),!0})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),children:[Object(w.jsx)(C.a,{}),Object(w.jsx)(I.a,{noConfirm:!0})]})}))),q=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e,i){var a;return Object(r.a)(this,n),(a=t.call(this,e,i)).state={loading:!0,thirdParty:"",info:"",token:"",sduId:""},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=Object(p.a)(this.props.location.search);m.a.thirdPartyLogin({thirdParty:t.thirdParty,ticket:t.ticket}).then((function(t){if(o.b.success(e.props.t("certificationSuccess")),null===t.user){var n={loading:!1,thirdParty:t.thirdParty,token:t.token};"SDUCAS"===t.thirdParty&&Object.assign(n,{info:t.sduRealName+" ("+t.sduId+")",sduId:t.sduId}),e.setState(n)}else e.props.history.push(V.g+"/home")}))}},{key:"render",value:function(){var e=this;return Object(w.jsx)("div",{className:"center",style:{width:450},children:[""].map((function(){return!0===e.state.loading?Object(w.jsx)(u.a,{tip:e.props.t("certificationIn..."),children:Object(w.jsx)("div",{style:{textAlign:"center",margin:"0 auto"},children:Object(w.jsx)("div",{children:Object(w.jsx)(l.a,{width:200,src:x.a,preview:!1})})})}):Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(d.a,{title:Object(w.jsxs)("span",{children:[e.props.t("firstTimeUse"),Object(w.jsx)("span",{style:{fontWeight:"bold"},children:e.state.thirdParty}),e.props.t("login,BindingOperationRequired")]}),children:Object(w.jsxs)(j.b,{direction:"vertical",size:15,children:[Object(w.jsxs)("div",{style:{textAlign:"left"},children:[e.props.t("certificationInformation:"),Object(w.jsx)("span",{style:{fontWeight:"bold"},children:e.state.info})]}),Object(w.jsxs)("div",{style:{textAlign:"left"},children:[e.props.t("statuteOfLimitationsCurrentCertification"),Object(w.jsx)("span",{style:{fontWeight:"bold"},children:e.props.t("5Minutes")}),e.props.t("validWithin")]}),Object(w.jsx)(S,{token:e.state.token,username:e.state.sduId,button:Object(w.jsx)(b.a,{block:!0,type:"primary",children:e.props.t("registerAsANewUserAndBind")})}),Object(w.jsx)(A,{token:e.state.token,button:Object(w.jsx)(b.a,{block:!0,type:"primary",children:e.props.t("bindExistingAccounts")})})]})})})}))})}}]),n}(c.Component);t.default=Object(f.b)((function(e){return{}}),(function(e){return{}}))(Object(h.a)()(Object(O.e)(q)))}}]);
//# sourceMappingURL=48.79877155.chunk.js.map