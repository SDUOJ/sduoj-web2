(this.webpackJsonpsduoj=this.webpackJsonpsduoj||[]).push([[51],{1018:function(e,t,n){"use strict";var a=n(31),o=n(88),s=n(984),r=n(1006),i=n(974),c=n(62),l=n(1125),u=n(983),d=n(0),b=n(99),m=n(76),j=n(421),f=n(41),p=n(309),O=n(66),h=n(1376),v=n(6);t.a=Object(m.b)((function(e){var t,n=e.UserReducer,o=e.TableReduce;return{roles:null===(t=n.userInfo)||void 0===t?void 0:t.roles,tableData:Object(a.a)({},o.tableData)}}),(function(e){return{setTableInfo:function(t,n){return e({type:"setTableInfo",name:t,data:n})},setDataSource:function(t,n){return e({type:"setDataSource",data:t,name:n,add:!1})}}}))(Object(j.a)()(Object(f.e)((function(e){var t,n=Object(d.useState)(0),m=Object(o.a)(n,2),j=m[0],f=m[1],S=Object(d.useState)(),g=Object(o.a)(S,2),y=g[0],x=g[1],I=Object(d.useState)(!0),w=Object(o.a)(I,2),T=w[0],C=w[1],R=Object(d.useState)(1),D=Object(o.a)(R,2),k=D[0],z=D[1],P=Object(d.useState)(Object(O.a)(e.defaultPageSize,b.h)),F=Object(o.a)(P,2),K=F[0],A=F[1],N=Object(d.useState)(),V=Object(o.a)(N,2),L=V[0],M=V[1],J=Object(d.useState)(0),E=Object(o.a)(J,2),B=E[0],U=E[1],Q=function(t){x(t),void 0!==e.setDataSource&&void 0!==e.name&&e.setDataSource(t,e.name)},$=function(t,n,o,s){var r,i,c,l,u,d,b,m,j,p=null===(r=e.tableData[e.name])||void 0===r?void 0:r.tableInfo;void 0!==p&&(void 0===s&&void 0!==p.moreProps&&H.setFieldsValue(p.moreProps),t=null!==(d=t)&&void 0!==d?d:p.pageNow,n=null!==(b=n)&&void 0!==b?b:p.pageSize,o=null!==(m=o)&&void 0!==m?m:p.searchKey,s=null!==(j=s)&&void 0!==j?j:p.moreProps);var O=null!==(i=t)&&void 0!==i?i:k,h=null!==(c=n)&&void 0!==c?c:K,v=null!==(l=o)&&void 0!==l?l:L,S=null!==(u=s)&&void 0!==u?u:H.getFieldsValue();z(O),A(h),M(v),C(!0),e.API(Object(a.a)({pageNow:O,pageSize:h,searchKey:v},S)).then((function(t){null===t.rows&&(t.rows=[]),void 0!==e.APIRowsTransForm?Q(e.APIRowsTransForm(t.rows)):Q(t.rows),void 0!==t.totalNum&&"0"!==t.totalNum?(f(t.totalNum),e.name&&e.setTableInfo(e.name,{total:t.totalNum,pageNow:O,pageSize:h,searchKey:v,moreProps:S})):(f(h*t.totalPage),e.name&&e.setTableInfo(e.name,{total:h*t.totalPage,pageNow:O,pageSize:h,searchKey:v,moreProps:S})),C(!1)}))};Object(d.useEffect)((function(){H.setFieldsValue(e.initRequestProps),$()}),[e.name]);var q=Object(h.a)(),H=Object(o.a)(q,1)[0],W=function(){var e=H.getFieldsValue();"{}"!==JSON.stringify(e)&&$(1,K,void 0,e)},Z=function(){var t,n=H.getFieldsValue();H.resetFields();var a=null===(t=e.tableData[e.name])||void 0===t?void 0:t.tableInfo;e.name&&e.setTableInfo(e.name,{total:a.total,pageNow:a.pageNow,pageSize:a.pageSize,searchKey:a.searchKey,moreProps:void 0});var o=H.getFieldsValue();JSON.stringify(n)!==JSON.stringify(o)&&$(1,K,void 0,void 0)};return Object(d.useEffect)((function(){var t,n=null===(t=e.tableData[e.name])||void 0===t?void 0:t.tableVersion;if(void 0!==n&&B!==n)if(n<0){var a;U(-n),x(null===(a=e.tableData[e.name])||void 0===a?void 0:a.dataSource)}else{U(n);var o=H.getFieldsValue();$(k,K,L,o)}}),[e.tableData,B]),Object(v.jsxs)(v.Fragment,{children:[e.useList&&Object(v.jsx)(s.a,{title:e.title,bordered:!0,size:"default",className:null!==(t=e.cardProps)&&void 0!==t?t:"zeroBodyPaddingLeft",extra:(!0===e.search||void 0!==e.getForm)&&Object(v.jsxs)(v.Fragment,{children:[!0===e.search&&Object(v.jsx)(p.a,{placeholder:e.t("searchUser"),onSearch:function(e){M(e),z(1);var t=H.getFieldsValue();$(1,K,e,t)},enterButton:!0,style:{width:300}},"search"),void 0!==e.getForm&&Object(v.jsxs)(r.a,{form:H,children:[e.getForm(W),e.useFormBtn&&Object(v.jsxs)(i.b,{style:{marginLeft:"30px"},size:20,children:[Object(v.jsx)(c.a,{type:"primary",onClick:W,children:"\u7b5b\u9009"}),Object(v.jsx)(c.a,{htmlType:"button",onClick:Z,children:"\u91cd\u7f6e"})]})]})]}),children:Object(v.jsx)(l.b,{grid:e.grid,itemLayout:"vertical",loading:T,size:e.size,dataSource:y,renderItem:e.renderItem,pagination:{onChange:function(e,t){$(e,t)},current:k,pageSize:K,total:j,size:"small",hideOnSinglePage:!0,showQuickJumper:!0,showLessItems:!0,showSizeChanger:Object(O.a)(e.showSizeChanger,!0),pageSizeOptions:["5","15","20","50","80"]}})}),!e.useList&&Object(v.jsx)(s.a,{bordered:!1,size:"small",extra:(!0===e.search||void 0!==e.getForm)&&Object(v.jsxs)(v.Fragment,{children:[!0===e.search&&Object(v.jsx)(p.a,{placeholder:"\u641c\u7d22",onSearch:function(e){M(e),z(1),$(1,K,e)},enterButton:!0,style:{width:300}},"search"),void 0!==e.getForm&&Object(v.jsxs)(r.a,{form:H,children:[e.getForm(W),Object(v.jsxs)(i.b,{style:{marginLeft:"30px"},size:20,children:[Object(v.jsx)(c.a,{type:"primary",onClick:W,children:e.t("filtering")}),Object(v.jsx)(c.a,{htmlType:"button",onClick:Z,children:e.t("Reset")})]})]})]}),children:Object(v.jsx)(u.a,{rowKey:e.rowKey,loading:T,size:e.size,columns:e.columns,rowSelection:e.rowSelection,dataSource:y,pagination:{onChange:function(e,t){$(e,t)},current:k,pageSize:K,total:j,hideOnSinglePage:!0,showQuickJumper:!0,showLessItems:!0,showSizeChanger:Object(O.a)(e.showSizeChanger,!0),pageSizeOptions:["5","15","20","50","80"]}})})]})}))))},1039:function(e,t,n){"use strict";var a=n(1060),o=n(31),s=n(88),r=n(983),i=n(0),c=n.n(i),l=n(76),u=n(421),d=n(41),b=n(1067),m=n(1447),j=n(1066),f=n(6),p=["className","style"];t.a=c.a.memo(Object(l.b)((function(e){var t=e.TableReduce;return{tableData:Object(o.a)({},t.tableData)}}),(function(e){return{setTableInfo:function(t,n){return e({type:"setTableInfo",name:t,data:n})},setDataSource:function(t,n){return e({type:"setDataSource",data:t,name:n,add:!1})}}}))(Object(u.a)()(Object(d.e)((function(e){var t=Object(i.useState)([]),n=Object(s.a)(t,2),c=n[0],l=n[1],u=Object(i.useState)(!0),d=Object(s.a)(u,2),O=d[0],h=d[1],v=Object(i.useState)(0),S=Object(s.a)(v,2),g=S[0],y=S[1],x=function(t){l(t),void 0!==e.setDataSource&&void 0!==e.name&&e.setDataSource(t,e.name)},I=function(){h(!0),e.API().then((function(t){null===t&&(t=[]),void 0!==e.APIRowsTransForm?x(e.APIRowsTransForm(t)):x(t),h(!1)}))};Object(i.useEffect)((function(){I()}),[e.name]),Object(i.useEffect)((function(){var t,n,a=null===(t=e.tableData[e.name])||void 0===t?void 0:t.tableVersion;void 0!==a&&g!==a&&(a<0?(y(-a),l(null===(n=e.tableData[e.name])||void 0===n?void 0:n.dataSource)):(y(a),I()))}),[e.tableData,g]);var w=Object(b.c)((function(){return Object(f.jsx)(m.a,{style:{cursor:"grab",color:"#999"}})})),T=Object(b.b)((function(e){return Object(f.jsx)("tr",Object(o.a)({},e))})),C=Object(b.a)((function(e){return Object(f.jsx)("tbody",Object(o.a)({},e))})),R=function(t){var n=t.oldIndex,a=t.newIndex;n!==a&&(x(Object(j.a)(c,n,a)),e.afterDrag&&e.afterDrag(c,n,a))},D=[{title:"",dataIndex:"sort",width:50,className:"drag-visable",render:function(){return Object(f.jsx)(w,{})}}],k=e.columns;return e.useDrag&&(k=D.concat(k)),Object(f.jsx)(r.a,Object(o.a)(Object(o.a)({},e),{},{rowSelection:e.rowSelection,rowKey:e.rowKey,loading:O,size:e.size,columns:k,dataSource:c,pagination:!1,components:{body:{wrapper:function(e){return Object(f.jsx)(C,Object(o.a)({useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:R},e))},row:function(t){t.className,t.style;var n=Object(a.a)(t,p),s=c.findIndex((function(t){return t[e.rowKey]===n["data-row-key"]}));return Object(f.jsx)(T,Object(o.a)({index:s},n))}}}}))})))),(function(e,t){var n,a;return e.columns===t.columns&&(null===(n=e.rowSelection)||void 0===n?void 0:n.selectedRowKeys.length)===(null===(a=t.rowSelection)||void 0===a?void 0:a.selectedRowKeys.length)&&e.tableData===t.tableData&&e.updateTrick===t.updateTrick}))},1040:function(e,t,n){"use strict";var a=n(31),o=n(139),s=n(88),r=n(421),i=n(62),c=n(974),l=n(1006),u=n(307),d=n(174),b=n(984),m=n(120),j=n(315),f=n(127),p=n(973),O=n(36),h=n(103),v=n(0),S=n(128),g=n.n(S),y=n(1041),x=n(196),I=n(76),w=n(41),T=n(66),C=n(194),R=n(6);t.a=Object(I.b)((function(e){var t,n=e.TableReduce,a=e.UserReducer;return{tableData:n.tableData,roles:null===(t=a.userInfo)||void 0===t?void 0:t.roles}}),(function(e){return{addTableVersion:function(t){return e({type:"addTableVersion",name:t})},setSelectedRowKeys:function(t,n){return e({type:"setSelectedRowKeys",data:t,name:n})},setDataSource:function(t,n){return e({type:"setDataSource",data:t,name:n,add:!0})},setTopSubmission:function(t,n){return e({type:"setTopSubmission",submissionID:t,submissionInfo:n})},setSubmissionModalVis:function(t){return e({type:"setSubmissionModalVis",data:t})}}}))(Object(r.a)()(Object(w.e)((function(e){var t,n,r=Object(v.useState)(!1),S=Object(s.a)(r,2),I=S[0],w=S[1],D=Object(v.useState)([]),k=Object(s.a)(D,2),z=k[0],P=k[1],F=Object(v.useState)(!1),K=Object(s.a)(F,2),A=K[0],N=K[1],V=Object(T.a)(null===(t=e.tableData[e.name])||void 0===t?void 0:t.selectedRowKeys,[]),L=Object(T.a)(null===(n=e.tableData[e.name])||void 0===n?void 0:n.dataSource,[]),M=function(t){e.setTopSubmission(t.submissionId,{title:t.problemTitle,TimeLimit:t.timeLimit,MemoryLimit:t.memoryLimit,scoreMod:void 0===t.sumScore?"disable":"show",sumScore:t.sumScore,testcaseMod:"show",QuerySubmissionAPI:e.QuerySubmissionAPI}),e.setSubmissionModalVis(!0)},J=[{title:e.t("results"),dataIndex:"result",key:"result",render:function(e,t){return Object(R.jsx)("div",{onClick:function(){M(t)},children:Object(R.jsx)(h.a,{type:"text",caseType:O.b.indexOf(O.c[e]),append:"-2"===e?"("+t.RunningStep+"/"+(t.checkpointNum+t.publicCheckpointNum)+")":""})})}},{title:e.t("score"),dataIndex:"score",key:"score",render:function(e,t){return void 0===t.sumScore?e:Math.floor(e/t.sumScore*100)+"%"}},{title:e.t("submissionTime"),dataIndex:"submitTime",key:"submitTime",render:function(e){return g()(e).fromNow()}}],E=[{title:"ID",dataIndex:"submissionId",key:"submissionId",render:function(e,t){return Object(R.jsx)(i.a,{type:"link",size:"small",onClick:function(){M(t)},children:e})}},{title:e.t("username"),dataIndex:"username",key:"username"},{title:e.t("problemNo."),dataIndex:"problemCode",key:"problemCode",render:e.problemCodeRender},{title:e.t("problemName"),dataIndex:"problemTitle",key:"problemTitle"},{title:e.t("results"),dataIndex:"result",key:"result",width:170,render:function(e,t){return Object(R.jsx)(h.a,{type:"text",caseType:O.b.indexOf(O.c[e]),append:"-2"===e?"("+t.RunningStep+"/"+(t.checkpointNum+t.publicCheckpointNum)+")":""})}},{title:e.t("score"),dataIndex:"score",key:"score",render:function(e,t){return void 0===t.sumScore?e:Math.floor(e/t.sumScore*100)+"%"}},{title:e.t("template"),dataIndex:"judgeTemplateTitle",key:"judgeTemplateTitle"},{title:e.t("memoryUsage"),dataIndex:"usedMemory",key:"usedMemory",render:function(e){return e+" KB"}},{title:e.t("timeUsage"),dataIndex:"usedTime",key:"usedTime",render:function(e){return e+" ms"}},{title:e.t("submissionTime"),dataIndex:"submitTime",key:"submitTime",render:function(e){return g()(e).fromNow()}}];return Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(b.a,{title:Object(R.jsxs)(c.b,{children:[void 0!==e.title?e.title:e.t("submissionRecord"),Object(R.jsx)(j.a,{open:I,dataHandle:function(t){var n=t[0],a=(t[1],t[2]),s=t[3],r=(t[4],t[5]),i=t[6],c=t[7],l=t[8],u=L,d=u.findIndex((function(e){return e.submissionId===n}));if(-1!==d){if(s<0){u[d].result=s.toString(),-1===s&&(u[d].result=r,u[d].score=i,u[d].usedTime=c,u[d].usedMemory=l);var b,m=0,j=Object(o.a)(u);try{for(j.s();!(b=j.n()).done;){var f=b.value;parseInt(f.result)<=0&&(m+=1)}}catch(O){j.e(O)}finally{j.f()}0===m&&w(!1)}else{var p=0;0===a?p=s+1:1===a&&(p=u[d].checkpointNum+s+1),u[d].RunningStep<p&&(u[d].RunningStep=p,u[d].score+=i)}e.setDataSource(u,e.name)}},queryList:z})]}),style:e.lessInfo?{}:{minWidth:1200},className:e.lessInfo?"smallBodyPadding":"",extra:Object(R.jsxs)(c.b,{children:[!0!==e.lessInfo&&Object(C.a)(e.roles,["admin","superadmin"])&&Object(R.jsx)(x.a,{API:f.a.rejudge,data:V,afterSuccess:function(){e.addTableVersion(e.name),e.setSelectedRowKeys([],e.name)}}),Object(R.jsx)(i.a,{icon:Object(R.jsx)(p.a,{}),onClick:function(){N(!0),e.addTableVersion(e.name),m.b.success(e.t("refreshSuccessfully")),setTimeout((function(){N(!1)}),3e3)},disabled:A,children:e.t("refresh")})]}),children:Object(R.jsx)(y.a,{disableSelection:e.lessInfo||!Object(C.a)(e.roles,["admin","superadmin"]),defaultPageSize:e.lessInfo?5:void 0,showSizeChanger:!e.lessInfo&&void 0,columns:e.lessInfo?J:E,getForm:!0===e.useForm?function(t){return Object(R.jsxs)(c.b,{size:30,children:[Object(R.jsx)(l.a.Item,{label:e.t("username"),name:"username",children:Object(R.jsx)(u.a,{onPressEnter:function(e){t()},allowClear:!0})}),Object(R.jsx)(l.a.Item,{label:e.t("problemNo."),name:"problemCode",children:Object(R.jsx)(u.a,{onPressEnter:function(e){t()},allowClear:!0})}),Object(R.jsx)(l.a.Item,{label:e.t("JudgeResult"),name:"judgeResult",children:Object(R.jsx)(d.a,{onChange:t,allowClear:!0,style:{width:200},children:O.a.map((function(e){return Object(R.jsx)(d.a.Option,{value:parseInt(e),children:Object(R.jsx)(h.a,{type:"text",caseType:O.b.indexOf(O.c[e])})})}))})})]})}:void 0,name:e.name,size:"small",rowKey:"submissionId",API:function(t){if("problemCode"in t&&!Object(T.c)(t.problemCode)){var n=t.problemCode;1===n.length?(null!==n.match(/^[a-z]$/)&&(n=(n.charCodeAt(0)-"a".charCodeAt(0)+1).toString()),null!==n.match(/^[A-Z]$/)&&(n=(n.charCodeAt(0)-"A".charCodeAt(0)+1).toString())):null!==n.match(/^[0-9]{4}$/)&&(n="SDUOJ-"+n),t.problemCode=n}return e.API(t)},APIRowsTransForm:function(e){Object(T.c)(e)&&(e=[]);var t,n=[],s=[],r=Object(o.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.judgeResult<=0&&n.push(i.submissionId),s.push(Object(a.a)(Object(a.a)({},i),{},{score:i.judgeScore,RunningStep:0,result:i.judgeResult.toString(),sumScore:i.sumScore,submitTime:parseInt(i.gmtCreate)}))}}catch(c){r.e(c)}finally{r.f()}return 0!==n.length&&(w(!0),P(n)),s}})})})}))))},1041:function(e,t,n){"use strict";var a=n(31),o=n(137),s=n(138),r=n(141),i=n(140),c=n(0),l=n(421),u=n(41),d=n(76),b=n(1018),m=n(66),j=n(1039),f=n(6),p=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).setSelectedRowKeys=function(t){e.props.setSelectedRowKeys(t,e.props.name)},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e,t=this,n=Object(m.a)(null===(e=this.props.tableData[this.props.name])||void 0===e?void 0:e.selectedRowKeys,[]),o={selectedRowKeys:n,onChange:function(e){t.setSelectedRowKeys(e)},selections:[{key:"all",text:this.props.t("selectedAll"),onSelect:function(e){var a=e;a=a.concat(n.filter((function(t){return!e.includes(t)}))),t.setSelectedRowKeys(a)}},{key:"clear",text:this.props.t("clear"),onSelect:function(e){var a=n.filter((function(t){return!e.includes(t)}));t.setSelectedRowKeys(a)}},{key:"invert",text:this.props.t("invert"),onSelect:function(e){var a=e.filter((function(e){return!n.includes(e)}));a=a.concat(n.filter((function(t){return!e.includes(t)}))),t.setSelectedRowKeys(a)}}]};return Object(f.jsxs)(f.Fragment,{children:[this.props.uesAlldata&&Object(f.jsx)(j.a,Object(a.a)(Object(a.a)({},this.props),{},{rowSelection:this.props.disableSelection?void 0:o})),!0!==this.props.uesAlldata&&Object(f.jsx)(b.a,Object(a.a)(Object(a.a)({},this.props),{},{rowSelection:this.props.disableSelection?void 0:o}))]})}}]),n}(c.Component);t.a=Object(d.b)((function(e){return{tableData:e.TableReduce.tableData}}),(function(e){return{setSelectedRowKeys:function(t,n){return e({type:"setSelectedRowKeys",data:t,name:n})}}}))(Object(l.a)()(Object(u.e)(p)))},1403:function(e,t,n){"use strict";n.r(t);var a=n(31),o=n(421),s=n(41),r=n(1040),i=n(127),c=n(62),l=(n(0),n(99)),u=n(6);t.default=Object(o.a)()(Object(s.e)((function(e){var t=e.match.params.contestId;return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)(r.a,{name:"ContestSubmission-"+t,useForm:!0,API:function(e){return i.a.getContestSubmissionList(Object(a.a)(Object(a.a)({},e),{},{contestId:t}))},QuerySubmissionAPI:function(e){return i.a.getContestSubmissionInfo({contestId:t,submissionId:e})},InvalidateAPI:function(e){return i.a.invalidateContestSubmission({submissionId:e.submissionId,contestId:t})},problemCodeRender:function(n){return Object(u.jsx)(c.a,{type:"text",size:"small",onClick:function(){e.history.push(l.g+"/contest/"+t+"/problem/"+n)},children:String.fromCharCode("A".charCodeAt(0)+parseInt(n)-1)})}})})})))}}]);
//# sourceMappingURL=51.1f7c3550.chunk.js.map