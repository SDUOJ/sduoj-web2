{"version":3,"sources":["Utils/MarkdownPreview.ts","Utils/MarkdownText.tsx","Component/common/LoginCheck.tsx","Component/common/Timer.tsx","Component/problemSet/Public.tsx"],"names":["host","MarkdownText","props","useState","running","setRunning","nowText","setNowText","useEffect","isValueEmpty","text","code","id","trim","replaceAll","config","mode","cdn","emojiPath","theme","path","hljs","lineNumber","markdown","toc","mark","footnotes","autoSpace","math","inlineDigit","engine","VditorPreview","preview","document","getElementById","MarkdownPreview","then","res","style","overflowY","connect","state","isLogin","UserReducer","dispatch","setUserInfo","data","userLogin","withTranslation","withRouter","cApi","getProfile","type","catch","history","replace","UrlPrefix","location","pathname","Timer","className","map","inline","t","value","deadline","format","onFinish","title","name","Component","problemSetId","match","params","Meta","Card","info","setInfo","State","TimeRangeState","tm_start","tm_end","undefined","getProblemSetPublic","psid","icon","extra","cover","actions","disabled","finish","onClick","push","Date","now","description","paddingBottom"],"mappings":"yIAMMA,EAFU,2B,kBCqBDC,IArBM,SAACC,GAElB,MAA8BC,oBAAkB,GAAhD,mBAAOC,EAAP,KAAgBC,EAAhB,KACA,EAA8BF,oBAAkB,GAAhD,mBAAOG,EAAP,KAAgBC,EAAhB,KAYA,OAVAC,qBAAU,WACDC,YAAaP,EAAMQ,OAAUN,GAAWE,IAAYJ,EAAMQ,OAC3DL,GAAW,GACXE,EAAWL,EAAMQ,MDJtB,SAAyBC,EAAiCC,GAAa,IAAD,OACrEH,YAAaE,IAASF,YAAY,UAACE,SAAD,aAAC,EAAME,WAASF,EAAO,IAG7DA,EAAI,UAFJA,EAAI,UAAGA,SAAH,aAAG,EAAMG,WAAW,yBAA0B,2BAE9C,aAAG,EAAMA,WAAW,gBAAiB,UACzC,IAAMC,EAAS,CACXC,KAAM,QACNC,IAAKjB,EAAO,UACZkB,UAAWlB,EAAO,4BAClBmB,MAAO,CACHC,KAAMpB,EAAO,kCAEjBqB,KAAM,CACFC,YAAY,GAEhBC,SAAU,CACNC,KAAK,EACLC,MAAM,EACNC,WAAW,EACXC,WAAW,GAEfC,KAAM,CACFC,aAAa,EACbC,OAAQ,UAIhB,OAAOC,IAAcC,QAAQC,SAASC,eAAetB,GAAKD,EAAMI,GCtBxDoB,CAAgBjC,EAAMQ,KAAMR,EAAMU,IAAIwB,MAAK,SAACC,GACxChC,GAAW,SAGpB,CAACH,EAAMU,GAAIV,EAAMQ,KAAMN,IAGtB,qBAAKQ,GAAIV,EAAMU,GAAI0B,MAAO,CAACC,UAAW,c,kCCpB9C,4DAqCeC,iBAVS,SAACC,GAErB,MAAO,CAACC,QADiBD,EAAME,YACRD,YAGA,SAACE,GAAD,MAA8B,CACrDC,YAAa,SAACC,GAAD,OAAeF,EAASE,IACrCC,UAAW,SAACD,GAAD,OAAeF,EAASE,OAGxBN,CAGbQ,cAAkBC,aAhCD,SAAC/C,GAahB,OAXAM,qBAAU,YACe,IAAlBN,EAAMwC,SACLQ,IAAKC,aAAaf,MAAK,SAACC,GACpBnC,EAAM2C,YAAY,CAACO,KAAM,cAAeN,KAAMT,IAC9CnC,EAAM6C,UAAU,CAACK,KAAM,iBACxBC,OAAM,WACLnD,EAAMoD,QAAQC,QAAQC,IAAY,aAAetD,EAAMuD,SAASC,eAGzE,CAACxD,EAAMwC,UAGN,mC,+ICTFiB,E,4JACF,WAAU,IAAD,OACL,OACI,qBAAKC,UAAW,QAAhB,SAEQ,CAAC,IAAIC,KAAI,WACL,OAAI,EAAK3D,MAAM4D,OAEP,cAAC,IAAD,CAAMF,UAAW,oBAAjB,SACI,eAAC,IAAD,WACI,eAAC,IAAD,CAAOA,UAAW,eAAlB,UACI,cAAC,IAAD,IACC,EAAK1D,MAAM6D,EAAE,aAFlB,QAIA,cAAC,IAAD,CACIC,MAAO,EAAK9D,MAAM+D,SAClBC,OAAO,6BACPC,SAAU,EAAKjE,MAAMiE,gBAOjC,cAAC,IAAD,UACI,cAAC,IAAD,CAAWC,MAAO,EAAKlE,MAAMmE,KAAML,MAAO,EAAK9D,MAAM+D,SAC1CC,OAAO,6BACPC,SAAU,EAAKjE,MAAMiE,sB,GA3BhDG,aAuCLtB,kBAAkBW,I,+KC0ClBX,wBAAkBC,aAlFlB,SAAC/C,GACZ,IAAMqE,EAAerE,EAAMsE,MAAMC,OAAOF,aAEjCG,EAAQC,IAARD,KACP,EAAwBvE,qBAAxB,mBAAOyE,EAAP,KAAaC,EAAb,KACMC,EAAQF,GAAQG,YAAeH,EAAKI,SAAUJ,EAAKK,QAEzDzE,qBAAU,gBACO0E,IAATN,GACA1B,IAAKiC,oBAAoB,CAACC,KAAMb,IAAenC,MAAK,SAACC,GACjDwC,EAAQxC,QAGjB,CAACuC,IASJ,OACI,qCACI,cAAC,IAAD,IACA,cAAC,IAAD,CACIhB,UAAW,QACXyB,KAAM,6BACNjB,MAAK,OAAEQ,QAAF,IAAEA,OAAF,EAAEA,EAAMP,KACbiB,MACI,qBAAK1B,UAAW,gBAAhB,SACI,cAAC,IAAD,CACI2B,MACI,qCACe,SAAVT,GACG,cAAC,IAAD,CAAOT,KAAMnE,EAAM6D,EAAE,aACdE,SAAQ,OAAEW,QAAF,IAAEA,OAAF,EAAEA,EAAMI,SAChBb,SAAU,kBAAMU,OAAQK,MAGxB,YAAVJ,GACG,cAAC,IAAD,CAAOT,KAAM,2BACNJ,SAAQ,OAAEW,QAAF,IAAEA,OAAF,EAAEA,EAAMK,YAKnCO,QAAS,CACL,CACI,cAAC,IAAD,CACIpC,KAAK,UAAUqC,SAAoB,YAAVX,GAAwC,KAAb,OAAJF,QAAI,IAAJA,OAAA,EAAAA,EAAMc,QACtDC,QAAS,WACLzF,EAAMoD,QAAQsC,KAAKpC,IAAS,sBAAkBe,EAAlB,eAHpC,cAjCfW,IAATN,EAA2B,GACX,IAAhBA,EAAKc,OAAqB,qBAC1Bd,EAAKK,OAASY,KAAKC,MAAc,qBAC9B5F,EAAM6D,EAAE,sBAwCKH,UAAW,iBA5Bf,UA8BMnD,YAAY,OAACmE,QAAD,IAACA,OAAD,EAACA,EAAMmB,cACjB,cAACrB,EAAD,CACIpC,MAAO,CAAC0D,cAAe,IACvBD,YACI,mCACI,cAAC,IAAD,CACInF,GAAI,yBACJF,KAAI,OAAEkE,QAAF,IAAEA,OAAF,EAAEA,EAAMmB,gBAGtBnC,UAAW","file":"static/js/54.6d98b01e.chunk.js","sourcesContent":["// @ts-ignore\nimport VditorPreview from 'vditor/dist/method.min'\nimport {isValueEmpty} from \"./empty\";\n\nconst runHost = \"https://oj.qd.sdu.edu.cn\"\nconst devHost = \"https://oj.cs.sdu.edu.cn:3000\"\nconst host = process.env.NODE_ENV === 'development' ? devHost : runHost;\n\nexport function MarkdownPreview(code: string | null | undefined, id: string) {\n    if (isValueEmpty(code) || isValueEmpty(code?.trim())) code = \"\"\n    code = code?.replaceAll(/`{3}\\n([-|0-9a-zA-Z])/g, \"```plaintext\\n$1\")\n    // 针对原本 $ 换行的公式，加以修正\n    code = code?.replaceAll(/\\$\\n(.*)\\n\\$/g, \"$ $1 $\")\n    const config = {\n        mode: \"light\",\n        cdn: host + \"/vditor\",\n        emojiPath: host + \"/vditor/dist/images/emoji\",\n        theme: {\n            path: host + \"/vditor/dist/css/content-theme\"\n        },\n        hljs: {\n            lineNumber: false\n        },\n        markdown: {\n            toc: true,\n            mark: true,\n            footnotes: true,\n            autoSpace: true,\n        },\n        math: {\n            inlineDigit: true,\n            engine: 'KaTeX'\n        }\n    }\n    // return VditorPreview.md2html(code, config)\n    return VditorPreview.preview(document.getElementById(id), code, config)\n}\n","import {MarkdownPreview} from \"./MarkdownPreview\";\nimport {useEffect, useState} from \"react\";\nimport {isValueEmpty} from \"./empty\";\n\nconst MarkdownText = (props: any) => {\n\n    const [running, setRunning] = useState<boolean>(false);\n    const [nowText, setNowText] = useState<boolean>(false);\n\n    useEffect(() => {\n        if (!isValueEmpty(props.text) && !running && nowText !== props.text) {\n            setRunning(true)\n            setNowText(props.text)\n            MarkdownPreview(props.text, props.id).then((res: any) => {\n                setRunning(false)\n            })\n        }\n    }, [props.id, props.text, running])\n\n    return (\n        <div id={props.id} style={{overflowY: \"hidden\"}}>\n        </div>\n    )\n}\n\nexport default MarkdownText\n","import {withRouter} from \"react-router-dom\";\nimport {Dispatch, useEffect} from \"react\";\nimport {connect} from \"react-redux\";\nimport {withTranslation} from \"react-i18next\";\nimport {UserState} from \"../../Type/Iuser\";\nimport cApi from \"Utils/API/c-api\"\nimport {UrlPrefix} from \"../../Config/constValue\";\n\nconst LoginCheck = (props: any) => {\n\n    useEffect(()=>{\n        if(props.isLogin === false){\n            cApi.getProfile().then((res: any)=>{\n                props.setUserInfo({type: \"setUserInfo\", data: res})\n                props.userLogin({type: \"userLogin\"})\n            }).catch(()=>{\n                props.history.replace(UrlPrefix + \"/login?to=\" + props.location.pathname)\n            })\n        }\n    }, [props.isLogin])\n\n    return (\n        <></>\n    )\n}\n\n\nconst mapStateToProps = (state: any) => {\n    const State: UserState = state.UserReducer\n    return {isLogin: State.isLogin}\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => ({\n    setUserInfo: (data: any) => dispatch(data),\n    userLogin: (data: any) => dispatch(data)\n})\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(withTranslation()(withRouter(LoginCheck)))","import React, {Component} from \"react\";\nimport Countdown from \"antd/lib/statistic/Countdown\";\nimport {Card, Space} from \"antd\";\nimport {ClockCircleOutlined} from \"@ant-design/icons\"\nimport {WithTranslation, withTranslation} from \"react-i18next\";\n\ninterface ITimer {\n    name?: string        // 如：距离考试结束还有\n    deadline: number\n    inline?: boolean\n    onFinish?:any\n}\n\nclass Timer extends Component<ITimer & WithTranslation, any> {\n    render() {\n        return (\n            <div className={\"Timer\"}>\n                {\n                    [''].map(() => {\n                        if (this.props.inline) {\n                            return (\n                                <Card className={\"Timer-inline-card\"}>\n                                    <Space>\n                                        <Space className={\"Timer-inline\"}>\n                                            <ClockCircleOutlined/>\n                                            {this.props.t(\"Countdown\")} :\n                                        </Space>\n                                        <Countdown\n                                            value={this.props.deadline}\n                                            format=\"H 时 m 分 s 秒\"\n                                            onFinish={this.props.onFinish}\n                                        />\n                                    </Space>\n                                </Card>\n                            )\n                        } else {\n                            return (\n                                <Card>\n                                    <Countdown title={this.props.name} value={this.props.deadline}\n                                               format=\"H 时 m 分 s 秒\"\n                                               onFinish={this.props.onFinish}\n                                    />\n                                </Card>\n                            )\n                        }\n                    })\n                }\n            </div>\n        )\n    }\n}\n\nexport default withTranslation()(Timer)","import {withRouter} from \"react-router-dom\";\nimport LoginCheck from \"../common/LoginCheck\";\nimport {Button, Card, Result} from \"antd\";\nimport Timer from \"../common/Timer\";\nimport {isValueEmpty} from \"../../Utils/empty\";\nimport React, {useEffect, useState} from \"react\";\nimport {TimeRangeState} from \"../../Utils/Time\";\nimport MarkdownText from \"../../Utils/MarkdownText\";\nimport cApi from \"../../Utils/API/c-api\"\nimport {UrlPrefix} from \"../../Config/constValue\";\nimport {withTranslation} from \"react-i18next\";\n\nconst Public = (props: any) => {\n    const problemSetId = props.match.params.problemSetId\n\n    const {Meta} = Card;\n    const [info, setInfo] = useState<any>()\n    const State = info && TimeRangeState(info.tm_start, info.tm_end)\n\n    useEffect(() => {\n        if (info === undefined) {\n            cApi.getProblemSetPublic({psid: problemSetId}).then((res: any) => {\n                setInfo(res)\n            })\n        }\n    }, [info])\n\n    const getStartText = () => {\n        if (info === undefined) return \"\"\n        if (info.finish === 1) return \"已交卷\"\n        if (info.tm_end < Date.now()) return \"已结束\"\n        return props.t(\"StartAnswering\")\n    }\n\n    return (\n        <>\n            <LoginCheck/>\n            <Result\n                className={\"Ewait\"}\n                icon={<></>}\n                title={info?.name}\n                extra={\n                    <div className={\"Ewait-content\"}>\n                        <Card\n                            cover={\n                                <>\n                                    {State === \"wait\" && (\n                                        <Timer name={props.t(\"Countdown\")}\n                                               deadline={info?.tm_start}\n                                               onFinish={() => setInfo(undefined)}\n                                        />\n                                    )}\n                                    {State === \"running\" && (\n                                        <Timer name={\"距离结束\"}\n                                               deadline={info?.tm_end}\n                                        />\n                                    )}\n                                </>\n                            }\n                            actions={[\n                                [\n                                    <Button\n                                        type=\"primary\" disabled={State !== \"running\" || info?.finish === 1}\n                                        onClick={() => {\n                                            props.history.push(UrlPrefix + `/problemSet/${problemSetId}/overview`)\n                                        }}\n                                    >\n                                        {getStartText()}\n                                    </Button>\n                                ]\n                            ]}\n                            className={\"exam-wait-card\"}\n                        >\n                            {!isValueEmpty(info?.description) && (\n                                <Meta\n                                    style={{paddingBottom: 40}}\n                                    description={\n                                        <>\n                                            <MarkdownText\n                                                id={\"problemSet-description\"}\n                                                text={info?.description}\n                                            />\n                                        </>\n                                    } className={\"exam-wait-tip\"}/>\n                            )}\n                        </Card>\n                    </div>\n                }\n            />\n        </>\n    )\n}\n\n\nexport default withTranslation()(withRouter(Public))\n"],"sourceRoot":""}