(this.webpackJsonpsduoj=this.webpackJsonpsduoj||[]).push([[55],{1111:function(e,t){},1214:function(e,t){},1215:function(e,t){},1397:function(e,t,n){"use strict";n.r(t);var a=n(143),i=n(251),s=n(31),c=n(88),r=n(0),u=n(80),d=n(76),l=n(127),o=n(120),j=n(202),b=n(983),O=n(62),x=n(1212),v=n(6);t.default=function(){var e=Object(d.d)((function(e){return e.UserReducer.isLogin})),t=Object(d.d)((function(e){return e.UserReducer.userInfo})),n={"\u4f18\u79c0":0,"\u826f\u597d":0,"\u4e2d\u7b49":0,"\u5dee":0},f=Object(r.useState)([]),h=Object(c.a)(f,2),p=h[0],y=h[1],m=Object(r.useState)({}),g=Object(c.a)(m,2),k=g[0],_=g[1],S=Object(r.useState)(!1),I=Object(c.a)(S,2),w=I[0],C=I[1],E=Object(r.useState)(n),F=Object(c.a)(E,2),M=F[0],R=F[1],T=Object(r.useState)(!1),U=Object(c.a)(T,2),J=U[0],K=U[1],L=Object(r.useState)(),W=Object(c.a)(L,2),A=W[0],B=W[1],D=Object(r.useState)(),G=Object(c.a)(D,2),q=G[0],z=G[1],H=function(){l.a.getSMEList({}).then((function(e){void 0!==e.error?o.b.error(e.error):"\u5df2\u6295\u7968"===e.status?(_(e.my_evaluations),y(e.to_evaluate),C(!0),R((function(){var t=Object(s.a)({},M);for(var n in e.my_evaluations){var a=e.my_evaluations[n];t[a]=(t[a]||0)+1}return Object(s.a)({},t)}))):y(e.to_evaluate)}))},N=function(){l.a.getSMEResult({}).then((function(e){K(e.admin),e.admin&&(B(e.vote_status),z(e.results))}))};Object(r.useEffect)((function(){e&&(H(),N())}),[e]);var P=[{title:"\u5b66\u53f7",dataIndex:"student_id",key:"student_id"},{title:"\u59d3\u540d",dataIndex:"name",key:"name"},{title:"\u8bc4\u4ef7",key:"evaluation",render:function(e,t){return Object(v.jsxs)(j.a.Group,{onChange:function(e){return function(e,t){var n=k[e];_(Object(s.a)(Object(s.a)({},k),{},Object(a.a)({},e,t))),R((function(e){var a=Object(s.a)({},e);return n&&(a[n]=(a[n]||1)-1),a[t]=(a[t]||0)+1,a}))}(t.student_id,e.target.value)},value:k[t.student_id],disabled:w,children:[Object(v.jsx)(j.a,{value:"\u4f18\u79c0",children:"\u4f18\u79c0"}),Object(v.jsx)(j.a,{value:"\u826f\u597d",children:"\u826f\u597d"}),Object(v.jsx)(j.a,{value:"\u4e2d\u7b49",children:"\u4e2d\u7b49"}),Object(v.jsx)(j.a,{value:"\u5dee",children:"\u5dee"})]})}}];return Object(v.jsxs)(v.Fragment,{children:[e&&Object(v.jsxs)("div",{style:{position:"fixed",right:"20px",top:"30%",background:"#f9f9f9",padding:"20px",boxShadow:"0px 0px 5px rgba(0, 0, 0, 0.1)"},children:[Object(v.jsx)(u.a,{level:5,children:"\u8bc4\u4ef7\u7edf\u8ba1"}),Object(v.jsxs)("p",{children:["\u4f18\u79c0: ",M["\u4f18\u79c0"]]}),Object(v.jsxs)("p",{children:["\u826f\u597d: ",M["\u826f\u597d"]]}),Object(v.jsxs)("p",{children:["\u4e2d\u7b49: ",M["\u4e2d\u7b49"]]}),Object(v.jsxs)("p",{children:["\u5dee: ",M["\u5dee"]]})]}),Object(v.jsxs)("div",{style:{textAlign:"center",margin:"0 auto"},children:[Object(v.jsx)(u.a,{children:" 22\u7ea7\u5b66\u7855\u4e92\u8bc4 "}),!e&&Object(v.jsx)(u.a,{level:5,children:" \u60a8\u672a\u767b\u5f55\uff0c\u8bf7\u5728\u53f3\u4e0a\u89d2\u4f7f\u7528\u3010SDU\u7edf\u4e00\u8eab\u4efd\u8ba4\u8bc1\u3011\u767b\u5f55 "}),w&&Object(v.jsx)(u.a,{level:5,children:" \u60a8\u5df2\u6295\u7968\uff0c\u60a8\u53ef\u4ee5\u67e5\u770b\u60a8\u7684\u6295\u7968\uff0c\u4f46\u662f\u4e0d\u80fd\u518d\u6b21\u7f16\u8f91 "}),e&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(u.a,{level:5,children:[" \u59d3\u540d\uff1a",null===t||void 0===t?void 0:t.nickname,"\uff0c\u5b66\u53f7\uff1a",null===t||void 0===t?void 0:t.username," "]}),Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(v.jsxs)("div",{style:{maxWidth:1200},children:[Object(v.jsx)(b.a,{columns:P,dataSource:p,rowKey:"student_id",pagination:!1}),Object(v.jsx)(O.a,{type:"primary",onClick:function(){console.log("\u63d0\u4ea4\u7684\u8bc4\u4ef7:",k),l.a.submitSME({evaluations:k}).then((function(e){void 0!==e.error?(o.b.error(e.error),void 0!==e.not_evaluated&&o.b.info(e.not_evaluated.toString()+" \u672a\u6295\u7968")):(o.b.success("\u6295\u7968\u6210\u529f"),H(),N(),R(n))}))},style:{marginTop:24},disabled:w,children:"\u63d0\u4ea4\u8bc4\u4ef7"})]})}),J&&q&&A&&Object(v.jsx)(v.Fragment,{children:Object(v.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:24},children:Object(v.jsxs)("div",{style:{maxWidth:1200},children:[Object(v.jsx)(u.a,{level:5,children:"\u6295\u7968\u72b6\u6001\u548c\u8bc4\u4ef7\u7ed3\u679c"}),Object(v.jsx)(O.a,{type:"primary",onClick:function(){var e=x.utils.json_to_sheet(Object(i.a)(Object.keys(A).map((function(e){return Object(s.a)({studentId:e,status:A[e]},q[e])})))),t=x.utils.book_new();x.utils.book_append_sheet(t,e,"Sheet1"),x.writeFile(t,"results.xlsx")},style:{marginTop:24,marginBottom:24},children:"\u5bfc\u51fa\u4e3a Excel"}),Object(v.jsx)(b.a,{dataSource:Object.keys(A).map((function(e){return Object(s.a)({studentId:e,status:A[e]},q[e])})),pagination:!1,columns:[{title:"\u5b66\u53f7",dataIndex:"studentId",key:"studentId"},{title:"\u72b6\u6001",dataIndex:"status",key:"status",filters:[{text:"\u5df2\u6295\u7968",value:"\u5df2\u6295\u7968"},{text:"\u672a\u6295\u7968",value:"\u672a\u6295\u7968"}],onFilter:function(e,t){return t.status.includes(e)}},{title:"\u4f18\u79c0",dataIndex:"\u4f18\u79c0",key:"\u4f18\u79c0",sorter:function(e,t){return e.\u4f18\u79c0-t.\u4f18\u79c0}},{title:"\u826f\u597d",dataIndex:"\u826f\u597d",key:"\u826f\u597d",sorter:function(e,t){return e.\u826f\u597d-t.\u826f\u597d}},{title:"\u4e2d\u7b49",dataIndex:"\u4e2d\u7b49",key:"\u4e2d\u7b49",sorter:function(e,t){return e.\u4e2d\u7b49-t.\u4e2d\u7b49}},{title:"\u5dee",dataIndex:"\u5dee",key:"\u5dee",sorter:function(e,t){return e.\u5dee-t.\u5dee}}],rowKey:"studentId"})]})})})]})]})]})}}}]);
//# sourceMappingURL=55.fd236b05.chunk.js.map