{"version":3,"sources":["Component/common/Table/TableWithPagination.tsx","Component/common/Table/TableWithAllData.tsx","Component/submission/SubmissionList/SubmissionList.tsx","Component/common/Table/TableWithSelection.tsx","Pages/Client/CSubmissions.tsx"],"names":["connect","state","UState","UserReducer","TState","TableReduce","roles","userInfo","tableData","dispatch","setTableInfo","name","data","type","setDataSource","add","withTranslation","withRouter","props","useState","total","setTotal","setTableDataX","loading","setLoading","PageNow","setPageNow","ck","defaultPageSize","PageSize","setPageSize","searchText","setSearchText","tableVersion","setTableVersion","setTableData","undefined","getInfo","pageNow","pageSize","searchKey","moreProps","propsTableInfo","tableInfo","form","setFieldsValue","pn","ps","sk","fmp","getFieldsValue","API","then","rows","APIRowsTransForm","totalNum","totalPage","useEffect","initRequestProps","useForm","onFinish","values","JSON","stringify","onReset","resetFields","tf","valuesAfter","propsTableVersion","dataSource","useList","title","bordered","size","className","cardProps","extra","search","getForm","placeholder","t","onSearch","text","enterButton","style","width","useFormBtn","marginLeft","onClick","htmlType","grid","itemLayout","renderItem","pagination","onChange","page","current","hideOnSinglePage","showQuickJumper","showLessItems","showSizeChanger","pageSizeOptions","rowKey","columns","rowSelection","React","memo","DragHandle","SortableHandle","cursor","color","SortableItem","SortableElement","XSortableContainer","SortableContainer","onSortEnd","oldIndex","newIndex","arrayMoveImmutable","afterDrag","sortColumns","dataIndex","render","useDrag","concat","components","body","wrapper","useDragHandle","disableAutoscroll","helperClass","row","restProps","index","findIndex","x","nextProps","selectedRowKeys","length","updateTrick","addTableVersion","setSelectedRowKeys","setTopSubmission","submissionID","submissionInfo","setSubmissionModalVis","webSocketOpen","setWebSocketOpen","webSocketQueryList","setWebSocketQueryList","refreshDisable","setRefreshDisable","showSubmission","record","submissionId","problemTitle","TimeLimit","timeLimit","MemoryLimit","memoryLimit","scoreMod","sumScore","testcaseMod","QuerySubmissionAPI","key","caseType","StateList","indexOf","SubmissionMap","append","RunningStep","checkpointNum","publicCheckpointNum","Math","floor","moment","fromNow","columnsAll","problemCodeRender","open","dataHandle","submissionIdHex","checkpointType","checkpointIndex","judgeResult","judgeScore","usedTime","usedMemory","dt","Index","value","result","toString","score","runningNumber","parseInt","nowID","queryList","lessInfo","minWidth","judgeAuth","cApi","rejudge","afterSuccess","icon","message","success","setTimeout","disabled","disableSelection","Item","label","onPressEnter","e","allowClear","RunningResultList","map","Option","isValueEmpty","v","match","charCodeAt","push","submitTime","gmtCreate","TableWithSelection","this","selections","onSelect","changeableRowKeys","newSelectedRowKeys","filter","includes","uesAlldata","Component","CSubmissions","textAlign","margin","maxWidth","getSubmissionList","getSubmissionInfo","split","history","UrlPrefix","fontWeight"],"mappings":"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","file":"static/js/16.70bca420.chunk.js","sourcesContent":["import {Button, Card, Form, List, Space, Table} from \"antd\";\nimport React, {Dispatch, useEffect, useState} from \"react\";\nimport {defaultPageSize} from \"../../../Config/constValue\";\nimport {UserState} from \"../../../Type/Iuser\";\nimport {connect} from \"react-redux\";\nimport {withTranslation} from \"react-i18next\";\nimport {withRouter} from \"react-router\";\nimport Search from \"antd/es/input/Search\";\nimport {TableState} from \"../../../Type/ITable\";\nimport {ck} from \"../../../Utils/empty\";\nimport {SizeType} from \"antd/lib/config-provider/SizeContext\";\nimport {ColumnsType} from \"antd/lib/table/interface\";\nimport {useForm} from \"antd/es/form/Form\";\n\nexport interface TableWithPaginationProps {\n    API: any                  // 表格查询数据的接口\n    size: SizeType            // 表格的大小\n    columns: ColumnsType<any> // 表格的列\n    name: string              // 表格名称\n    APIRowsTransForm?: any    // 针对API传输的数据进行转化的函数\n    search?: boolean          // 是否开启搜索功能\n    defaultPageSize?: number  // 表格默认的页大小\n\n    // 面向 可选择的行 开放的接口\n    // setDataSource?: any       // 输出当前表格的数据\n    rowKey?: any              // 作为 key 记录的值\n    rowSelection?: any        // 可选列的相关配置\n\n}\n\nconst TableWithPagination = (props: any) => {\n    const [total, setTotal] = useState<number>(0)                   // 项的总数\n    const [tableData, setTableDataX] = useState()                            // 表格核心数据\n    const [loading, setLoading] = useState(true)                    // 表格的加载状态\n    const [PageNow, setPageNow] = useState<number>(1)               // 当前的页码数\n    const [PageSize, setPageSize] = useState<number>(ck(props.defaultPageSize, defaultPageSize))         // 当前的页大小\n    const [searchText, setSearchText] = useState<string | undefined>()        // 搜索的文本\n    const [tableVersion, setTableVersion] = useState<number>(0)     // 表格版本（控制表格刷新）\n\n    const setTableData = (data: any) => {\n        setTableDataX(data)\n        // 若有 选中行 的相关配置，传递数据进行更新\n        if (props.setDataSource !== undefined && props.name !== undefined)\n            props.setDataSource(data, props.name)\n    }\n    // 这里的所有的参数都只能增量的修改，不能删除，删除需要手动更新 redux\n    const getInfo = (pageNow?: number, pageSize?: number, searchKey?: string, moreProps?: any) => {\n        const propsTableInfo = props.tableData[props.name]?.tableInfo\n        if (propsTableInfo !== undefined) {\n            if (moreProps === undefined && propsTableInfo.moreProps !== undefined){\n                form.setFieldsValue(propsTableInfo.moreProps)\n            }\n            pageNow = pageNow ?? propsTableInfo.pageNow\n            pageSize = pageSize ?? propsTableInfo.pageSize\n            searchKey = searchKey ?? propsTableInfo.searchKey\n            moreProps = moreProps ?? propsTableInfo.moreProps\n        }\n        let pn = pageNow ?? PageNow\n        let ps = pageSize ?? PageSize\n        let sk = searchKey ?? searchText\n        let fmp = moreProps ?? form.getFieldsValue()\n        setPageNow(pn)\n        setPageSize(ps)\n        setSearchText(sk)\n        setLoading(true)\n        props.API({\n            pageNow: pn,\n            pageSize: ps,\n            searchKey: sk,\n            ...fmp\n        }).then((data: any) => {\n            // console.log(\"data\", data)\n            if (data.rows === null) data.rows = []\n            if (props.APIRowsTransForm !== undefined) {\n                setTableData(props.APIRowsTransForm(data.rows))\n            } else setTableData(data.rows)\n            if (data.totalNum !== undefined && data.totalNum !== \"0\") {\n                setTotal(data.totalNum)\n                props.name && props.setTableInfo(props.name, {\n                    total: data.totalNum,\n                    pageNow: pn,\n                    pageSize: ps,\n                    searchKey: sk,\n                    moreProps: fmp\n                })\n            } else {\n                setTotal(ps * data.totalPage);\n                props.name && props.setTableInfo(props.name, {\n                    total: ps * data.totalPage,\n                    pageNow: pn,\n                    pageSize: ps,\n                    searchKey: sk,\n                    moreProps: fmp\n                })\n            }\n            setLoading(false)\n        })\n    }\n\n    useEffect(() => {\n        form.setFieldsValue(props.initRequestProps)\n        getInfo()\n    }, [props.name])\n\n    // 带有表单的筛选\n    const [form] = useForm()\n    const onFinish = () => {\n        const values = form.getFieldsValue()\n        if (JSON.stringify(values) !== \"{}\")\n            getInfo(1, PageSize, undefined, values)\n    };\n    const onReset = () => {\n        const values = form.getFieldsValue()\n        form.resetFields();\n        const tf = props.tableData[props.name]?.tableInfo\n        props.name && props.setTableInfo(props.name, {\n            total: tf.total,\n            pageNow: tf.pageNow,\n            pageSize: tf.pageSize,\n            searchKey: tf.searchKey,\n            moreProps: undefined\n        })\n        const valuesAfter = form.getFieldsValue()\n        // 重置前后若发生改变，则重新加载表格\n        if (JSON.stringify(values) !== JSON.stringify(valuesAfter))\n            getInfo(1, PageSize, undefined, undefined)\n\n    };\n\n\n    useEffect(() => {\n        // 监听表格的版本变化，当版本变更时更新表格\n        const propsTableVersion = props.tableData[props.name]?.tableVersion\n        if (propsTableVersion !== undefined && tableVersion !== propsTableVersion) {\n            // 如果数据被外部应用更新，则用 redux 中的数据更新当前行\n            if (propsTableVersion < 0) {\n                setTableVersion(-propsTableVersion)\n                setTableDataX(props.tableData[props.name]?.dataSource)\n            } else {\n                // 否则，重新进行请求\n                setTableVersion(propsTableVersion)\n                const values = form.getFieldsValue()\n                getInfo(PageNow, PageSize, searchText, values)\n            }\n        }\n    }, [props.tableData, tableVersion])\n\n    return (\n        <>\n            {props.useList && (\n                <Card\n                    title={props.title}\n                    bordered={true}\n                    size={\"default\"}\n                    className={props.cardProps ?? \"zeroBodyPaddingLeft\"}\n                    extra={\n                        (props.search === true || props.getForm !== undefined) && (\n                            <>\n                                {props.search === true && (\n                                    <Search\n                                        key={\"search\"}\n                                        placeholder={props.t(\"searchUser\")}\n                                        onSearch={(text) => {\n                                            setSearchText(text)\n                                            setPageNow(1)\n                                            const values = form.getFieldsValue()\n                                            getInfo(1, PageSize, text, values)\n                                        }}\n                                        enterButton\n                                        style={{width: 300}}\n                                    />\n                                )}\n                                {props.getForm !== undefined && (\n                                    <Form form={form}>\n                                        {props.getForm(onFinish)}\n                                        {props.useFormBtn && (\n                                            <Space style={{marginLeft: \"30px\"}} size={20}>\n                                                <Button type=\"primary\" onClick={onFinish}>\n                                                    筛选\n                                                </Button>\n                                                <Button htmlType=\"button\" onClick={onReset}>\n                                                    重置\n                                                </Button>\n                                            </Space>\n                                        )}\n                                    </Form>\n                                )}\n                            </>\n                        )\n                    }\n                >\n                    <List\n                        grid={props.grid}\n                        itemLayout={\"vertical\"}\n                        loading={loading}\n                        size={props.size}\n                        dataSource={tableData}\n                        renderItem={props.renderItem}\n                        pagination={{\n                            onChange: (page, pageSize) => {\n                                getInfo(page, pageSize)\n                            },\n                            current: PageNow,\n                            pageSize: PageSize,\n                            total: total,\n                            size: \"small\",\n                            hideOnSinglePage: true,\n                            showQuickJumper: true,\n                            showLessItems: true,\n                            showSizeChanger: ck(props.showSizeChanger, true),\n                            pageSizeOptions: [\"5\", \"15\", \"20\", \"50\", \"80\"],\n                        }}\n                    />\n                </Card>\n            )}\n            {!props.useList && (\n                <Card\n                    bordered={false}\n                    size={\"small\"}\n                    extra={\n                        (props.search === true || props.getForm !== undefined) && (\n                            <>\n                                {props.search === true && (\n                                    <Search\n                                        key={\"search\"}\n                                        placeholder={\"搜索\"}\n                                        onSearch={(text) => {\n                                            setSearchText(text)\n                                            setPageNow(1)\n                                            getInfo(1, PageSize, text)\n                                        }}\n                                        enterButton\n                                        style={{width: 300}}\n                                    />\n                                )}\n                                {props.getForm !== undefined && (\n                                    <Form form={form}>\n                                        {props.getForm(onFinish)}\n                                        <Space style={{marginLeft: \"30px\"}} size={20}>\n                                            <Button type=\"primary\" onClick={onFinish}>\n                                                {props.t(\"filtering\")}\n                                            </Button>\n                                            <Button htmlType=\"button\" onClick={onReset}>\n                                                {props.t(\"Reset\")}\n                                            </Button>\n                                        </Space>\n                                    </Form>\n                                )}\n                            </>\n                        )\n                    }\n                >\n                    <Table\n                        rowKey={props.rowKey}\n                        loading={loading}\n                        size={props.size}\n                        columns={props.columns}\n                        rowSelection={props.rowSelection}\n                        dataSource={tableData}\n                        pagination={{\n                            onChange: (page, pageSize) => {\n                                getInfo(page, pageSize)\n                            },\n                            current: PageNow,\n                            pageSize: PageSize,\n                            total: total,\n                            hideOnSinglePage: true,\n                            showQuickJumper: true,\n                            showLessItems: true,\n                            showSizeChanger: ck(props.showSizeChanger, true),\n                            pageSizeOptions: [\"5\", \"15\", \"20\", \"50\", \"80\"],\n                        }}\n                    />\n                </Card>\n            )}\n        </>\n    )\n\n}\n\nconst mapStateToProps = (state: any) => {\n    const UState: UserState = state.UserReducer\n    const TState: TableState = state.TableReduce\n    return {\n        roles: UState.userInfo?.roles,\n        tableData: {...TState.tableData}\n    }\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => ({\n    setTableInfo: (name: string, data: any) => dispatch({\n        type: \"setTableInfo\",\n        name: name,\n        data: data\n    }),\n    setDataSource: (data: any, name: string) =>\n        dispatch({type: \"setDataSource\", data: data, name: name, add: false})\n})\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(withTranslation()(\n    withRouter(TableWithPagination)\n))\n\n","import {Table} from \"antd\";\nimport React, {Dispatch, useEffect, useState} from \"react\";\nimport {connect} from \"react-redux\";\nimport {withTranslation} from \"react-i18next\";\nimport {withRouter} from \"react-router\";\nimport {TableState} from \"../../../Type/ITable\";\nimport {SizeType} from \"antd/lib/config-provider/SizeContext\";\nimport {ColumnsType} from \"antd/lib/table/interface\";\nimport {SortableContainer, SortableElement, SortableHandle} from \"react-sortable-hoc\";\nimport {MenuOutlined} from \"@ant-design/icons\";\nimport {arrayMoveImmutable} from \"array-move\";\n\nexport interface TableWithPaginationProps {\n    API: any                  // 表格查询数据的接口\n    size: SizeType            // 表格的大小\n    columns: ColumnsType<any> // 表格的列\n    name: string              // 表格名称\n    APIRowsTransForm?: any    // 针对API传输的数据进行转化的函数\n\n    // 面向 可选择的行 开放的接口\n    rowKey?: any              // 作为 key 记录的值\n\n}\n\nconst TableWithAllData = (props: any) => {\n    const [tableData, setTableDataX] = useState([])                            // 表格核心数据\n    const [loading, setLoading] = useState(true)                    // 表格的加载状态\n    const [tableVersion, setTableVersion] = useState<number>(0)     // 表格版本（控制表格刷新）\n    // const [sortSwitch, setSortSwitch] = useState<boolean>(false);           // 操作是否开启排序模式\n\n\n    const setTableData = (data: any) => {\n        setTableDataX(data)\n        // 若有 选中行 的相关配置，传递数据进行更新\n        if (props.setDataSource !== undefined && props.name !== undefined)\n            props.setDataSource(data, props.name)\n    }\n\n    const getInfo = () => {\n        setLoading(true)\n        props.API().then((data: any) => {\n            // console.log(\"data\", data)\n            if (data === null) data = []\n            if (props.APIRowsTransForm !== undefined) {\n                setTableData(props.APIRowsTransForm(data))\n            } else setTableData(data)\n            setLoading(false)\n        })\n    }\n\n    useEffect(() => {\n        getInfo()\n    }, [props.name])\n\n    useEffect(() => {\n        // 监听表格的版本变化，当版本变更时更新表格\n        const propsTableVersion = props.tableData[props.name]?.tableVersion\n        if (propsTableVersion !== undefined && tableVersion !== propsTableVersion) {\n            // 如果数据被外部应用更新，则用 redux 中的数据更新当前行\n            if (propsTableVersion < 0) {\n                setTableVersion(-propsTableVersion)\n                setTableDataX(props.tableData[props.name]?.dataSource)\n            } else {\n                // 否则，重新进行请求\n                setTableVersion(propsTableVersion)\n                getInfo()\n            }\n        }\n    }, [props.tableData, tableVersion])\n\n    // === 拖拽排序 ===\n    // 可拖拽的排序手柄\n    const DragHandle = SortableHandle(() => <MenuOutlined style={{cursor: 'grab', color: '#999'}}/>);\n    const SortableItem = SortableElement((props: any) => <tr {...props} />);\n    const XSortableContainer = SortableContainer((props: any) => <tbody {...props} />);\n    // 排序结束后\n    const onSortEnd = ({oldIndex, newIndex}: any) => {\n        // 当前排序是有效的\n        if (oldIndex !== newIndex) {\n            // 移动数组中的元素，并设置到当前的状态\n            setTableData(arrayMoveImmutable(tableData, oldIndex, newIndex))\n            props.afterDrag && props.afterDrag(tableData, oldIndex, newIndex)\n        }\n    };\n    const DraggableContainer = (props: any) => {\n        return (\n            <XSortableContainer\n                useDragHandle\n                disableAutoscroll\n                helperClass=\"row-dragging\"\n                onSortEnd={onSortEnd}\n                {...props}\n            />\n        )\n    }\n    const DraggableBodyRow = ({className, style, ...restProps}: any) => {\n        // function findIndex base on Table rowKey props and should always be a right array index\n        const index = tableData.findIndex((x: any) => x[props.rowKey] === restProps['data-row-key']);\n        return <SortableItem index={index} {...restProps} />\n    };\n    const sortColumns: any[] = [\n        {\n            title: \"\",\n            dataIndex: 'sort',\n            width: 50,\n            className: \"drag-visable\",\n            render: () => <DragHandle/>,\n        }\n    ]\n\n    let columns = props.columns;\n    if (props.useDrag) columns = sortColumns.concat(columns)\n\n    return (\n        <Table\n            {...props}\n            rowSelection={props.rowSelection}\n            rowKey={props.rowKey}\n            loading={loading}\n            size={props.size}\n            columns={columns}\n            dataSource={tableData}\n            pagination={false}\n            components={{\n                body: {\n                    wrapper: DraggableContainer,\n                    row: DraggableBodyRow,\n                },\n            }}\n        />\n    )\n\n}\n\nconst mapStateToProps = (state: any) => {\n    const TState: TableState = state.TableReduce\n    return {\n        tableData: {...TState.tableData}\n    }\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => ({\n    setTableInfo: (name: string, data: any) => dispatch({\n        type: \"setTableInfo\",\n        name: name,\n        data: data\n    }),\n    setDataSource: (data: any, name: string) =>\n        dispatch({type: \"setDataSource\", data: data, name: name, add: false})\n})\n\nexport default React.memo(connect(\n        mapStateToProps,\n        mapDispatchToProps\n    )(withTranslation()(\n        withRouter(TableWithAllData))), (props: any, nextProps: any) => {\n        return props.columns === nextProps.columns &&\n            (props.rowSelection?.selectedRowKeys.length === nextProps.rowSelection?.selectedRowKeys.length) &&\n            props.tableData === nextProps.tableData &&\n            props.updateTrick ===  nextProps.updateTrick\n    }\n)\n\n","import {withTranslation} from \"react-i18next\";\nimport {Button, Card, Form, Input, message, Select, Space} from \"antd\";\nimport {SyncJudging} from \"../SyncJudging\";\nimport cApi from \"../../../Utils/API/c-api\";\nimport {ReloadOutlined} from \"@ant-design/icons\";\nimport {RunningResultList, StateList, SubmissionMap, TopSubmissionInfoType} from \"../../../Type/ISubmission\";\nimport TestCase from \"../TestCase\";\nimport React, {Dispatch, useState} from \"react\";\nimport moment from \"moment\";\nimport TableWithSelection from \"../../common/Table/TableWithSelection\";\nimport ReJudge from \"../Func/ReJudge\";\nimport {connect} from \"react-redux\";\nimport {withRouter} from \"react-router\";\nimport {TableState} from \"../../../Type/ITable\";\nimport {ck, isValueEmpty} from \"../../../Utils/empty\";\nimport {UserState} from \"../../../Type/Iuser\";\nimport judgeAuth from \"../../../Utils/judgeAhtu\";\n\nconst SubmissionList = (props: any) => {\n\n    // 为了动态显示评测点信息，使用 ws 与后端进行链接\n    // ws 是否打开\n    const [webSocketOpen, setWebSocketOpen] = useState<boolean>(false)\n    // ws 发送的信息（在打开时，当前数据的变更将同步发送至 ws）\n    const [webSocketQueryList, setWebSocketQueryList] = useState<string[]>([])\n    const [refreshDisable, setRefreshDisable] = useState<boolean>(false)\n\n    const selectedRowKeys = ck(props.tableData[props.name]?.selectedRowKeys, [])\n    const dataSource = ck(props.tableData[props.name]?.dataSource, [])\n\n    const addCaseInfo = (data: any[]) => {\n\n        const submissionIdHex = data[0]\n        const submissionVersion = data[1]\n        const checkpointType = data[2]\n        const checkpointIndex = data[3]\n        const checkpointId = data[4]\n        const judgeResult = data[5]\n        const judgeScore = data[6]\n        const usedTime = data[7]\n        const usedMemory = data[8]\n\n        let dt = dataSource\n        const Index = dt.findIndex((value: any) => value.submissionId === submissionIdHex)\n        if (Index === -1) return\n        if (checkpointIndex < 0) {\n            dt[Index].result = checkpointIndex.toString()\n            if (checkpointIndex === -1) {\n                dt[Index].result = judgeResult\n                dt[Index].score = judgeScore\n                dt[Index].usedTime = usedTime\n                dt[Index].usedMemory = usedMemory\n            }\n            // 检查还有没有未更新完的\n            let runningNumber = 0\n            for (const x of dt) if (parseInt(x.result) <= 0) runningNumber += 1\n            if (runningNumber === 0) setWebSocketOpen(false)\n        } else {\n            let nowID = 0\n            if (checkpointType === 0) {\n                nowID = checkpointIndex + 1\n            } else if (checkpointType === 1) {\n                nowID = dt[Index].checkpointNum + checkpointIndex + 1\n            }\n            if (dt[Index].RunningStep < nowID) {\n                dt[Index].RunningStep = nowID\n                dt[Index].score += judgeScore\n            }\n        }\n        props.setDataSource(dt, props.name)\n    }\n\n    const showSubmission = (record: any) => {\n        props.setTopSubmission(record.submissionId, {\n            title: record.problemTitle,\n            TimeLimit: record.timeLimit,\n            MemoryLimit: record.memoryLimit,\n            scoreMod: record.sumScore === undefined ? \"disable\" : \"show\",\n            sumScore: record.sumScore,\n            testcaseMod: \"show\",\n            QuerySubmissionAPI: props.QuerySubmissionAPI\n        })\n        props.setSubmissionModalVis(true)\n    }\n\n    const columns = [\n        {\n            title: props.t(\"results\"),\n            dataIndex: \"result\",\n            key: \"result\",\n            render: (text: any, record: any) => {\n                return (\n                    <div onClick={() => {\n                        showSubmission(record)\n                    }}>\n                        <TestCase\n                            type={\"text\"}\n                            caseType={StateList.indexOf(SubmissionMap[text])}\n                            append={\n                                text === \"-2\" ?\n                                    \"(\" + record.RunningStep + \"/\" + (record.checkpointNum + record.publicCheckpointNum) + \")\"\n                                    : \"\"\n                            }\n                        />\n                    </div>\n\n                )\n            }\n        },\n        {\n            title: props.t(\"score\"),\n            dataIndex: \"score\",\n            key: \"score\",\n            render: (text: number, record: any) => {\n                if (record.sumScore === undefined)\n                    return text\n                return Math.floor(text / record.sumScore * 100) + \"%\"\n            }\n        },\n        {\n            title: props.t(\"submissionTime\"),\n            dataIndex: \"submitTime\",\n            key: \"submitTime\",\n            render: (text: any) => {\n                return moment(text).fromNow();\n            }\n        }\n    ]\n\n    const columnsAll = [\n        {\n            title: \"ID\",\n            dataIndex: \"submissionId\",\n            key: \"submissionId\",\n            render: (text: any, record: any) => {\n                return <Button type={\"link\"} size={\"small\"} onClick={() => {\n                    showSubmission(record)\n                }}>\n                    {text}\n                </Button>\n            }\n        },\n        {\n            title: props.t(\"username\"),\n            dataIndex: \"username\",\n            key: \"username\"\n        },\n        {\n            title: props.t(\"problemNo.\"),\n            dataIndex: \"problemCode\",\n            key: \"problemCode\",\n            render: props.problemCodeRender\n        },\n        {\n            title: props.t(\"problemName\"),\n            dataIndex: \"problemTitle\",\n            key: \"problemTitle\"\n        },\n        {\n            title: props.t(\"results\"),\n            dataIndex: \"result\",\n            key: \"result\",\n            width: 170,\n            render: (text: any, record: any) => {\n                return <TestCase\n                    type={\"text\"}\n                    caseType={StateList.indexOf(SubmissionMap[text])}\n                    append={\n                        text === \"-2\" ?\n                            \"(\" + record.RunningStep + \"/\" + (record.checkpointNum + record.publicCheckpointNum) + \")\" :\n                            \"\"\n                    }\n                />\n            }\n        },\n        {\n            title: props.t(\"score\"),\n            dataIndex: \"score\",\n            key: \"score\",\n            render: (text: number, record: any) => {\n                if (record.sumScore === undefined)\n                    return text\n                return Math.floor(text / record.sumScore * 100) + \"%\"\n            }\n        },\n        {\n            title: props.t(\"template\"),\n            dataIndex: \"judgeTemplateTitle\",\n            key: \"judgeTemplateTitle\"\n        },\n        {\n            title: props.t(\"memoryUsage\"),\n            dataIndex: \"usedMemory\",\n            key: \"usedMemory\",\n            render: (text: any) => {\n                return text + \" KB\"\n            }\n        },\n        {\n            title: props.t(\"timeUsage\"),\n            dataIndex: \"usedTime\",\n            key: \"usedTime\",\n            render: (text: any) => {\n                return text + \" ms\"\n            }\n        },\n        {\n            title: props.t(\"submissionTime\"),\n            dataIndex: \"submitTime\",\n            key: \"submitTime\",\n            render: (text: any) => {\n                return moment(text).fromNow();\n            }\n        }\n    ]\n\n    const getForm = (onFinish: any) => {\n        return (\n            <Space size={30}>\n                <Form.Item label={props.t(\"username\")} name={\"username\"}>\n                    <Input\n                        onPressEnter={(e: any) => {\n                            onFinish()\n                        }}\n                        allowClear\n                    />\n                </Form.Item>\n                <Form.Item label={props.t(\"problemNo.\")} name={\"problemCode\"}>\n                    <Input\n                        onPressEnter={(e: any) => {\n                            onFinish()\n                        }}\n                        allowClear\n                    />\n                </Form.Item>\n                <Form.Item label={props.t(\"JudgeResult\")} name={\"judgeResult\"}>\n                    <Select onChange={onFinish} allowClear style={{width: 200}}>\n                        {\n                            RunningResultList.map((value) => {\n                                return <Select.Option value={parseInt(value)}>\n                                    <TestCase type={\"text\"}\n                                              caseType={StateList.indexOf(SubmissionMap[value])}/>\n                                </Select.Option>\n                            })\n                        }\n                    </Select>\n                </Form.Item>\n            </Space>\n        )\n    }\n\n    const API = (data: any) => {\n        if (\"problemCode\" in data && !isValueEmpty(data[\"problemCode\"])) {\n            let v: string = data[\"problemCode\"]\n            if (v.length === 1) {\n                if (v.match(/^[a-z]$/) !== null) v = (v.charCodeAt(0) - 'a'.charCodeAt(0) + 1).toString()\n                if (v.match(/^[A-Z]$/) !== null) v = (v.charCodeAt(0) - 'A'.charCodeAt(0) + 1).toString()\n            } else if (v.match(/^[0-9]{4}$/) !== null) {\n                v = \"SDUOJ-\" + v\n            }\n            data[\"problemCode\"] = v\n        }\n        return props.API(data)\n    }\n\n    return (\n        <>\n            <Card\n                title={\n                    <Space>\n                        {props.title !== undefined ? props.title : props.t(\"submissionRecord\")}\n                        <SyncJudging\n                            open={webSocketOpen}\n                            dataHandle={addCaseInfo}\n                            queryList={webSocketQueryList}/>\n                    </Space>\n                }\n                style={props.lessInfo ? {} : {minWidth: 1200}}\n                className={props.lessInfo ? \"smallBodyPadding\" : \"\"}\n                extra={\n                    <Space>\n                        {props.lessInfo !== true && judgeAuth(props.roles, [\"admin\", \"superadmin\"]) && (\n                            <ReJudge\n                                API={cApi.rejudge}\n                                data={selectedRowKeys}\n                                afterSuccess={() => {\n                                    props.addTableVersion(props.name)\n                                    props.setSelectedRowKeys([], props.name)\n                                }}\n                            />\n                        )}\n                        <Button\n                            icon={<ReloadOutlined/>}\n                            onClick={() => {\n                                setRefreshDisable(true)\n                                props.addTableVersion(props.name)\n                                message.success(props.t(\"refreshSuccessfully\"))\n                                setTimeout(() => {\n                                    setRefreshDisable(false)\n                                }, 3000)\n                            }}\n                            disabled={refreshDisable}\n                        >\n                            {props.t(\"refresh\")}\n                        </Button>\n                    </Space>\n                }\n            >\n                <TableWithSelection\n                    disableSelection={props.lessInfo || !judgeAuth(props.roles, [\"admin\", \"superadmin\"])}\n                    defaultPageSize={props.lessInfo ? 5 : undefined}\n                    showSizeChanger={props.lessInfo ? false : undefined}\n                    columns={props.lessInfo ? columns : columnsAll}\n                    getForm={props.useForm === true ? getForm : undefined}\n                    name={props.name}\n                    size={\"small\"}\n                    rowKey={\"submissionId\"}\n                    API={API}\n                    APIRowsTransForm={(value: any) => {\n                        if (isValueEmpty(value)) value = []\n                        let webSocketQueryList = []\n                        let data: any = []\n                        for (const x of value) {\n                            if (x.judgeResult <= 0) webSocketQueryList.push(x.submissionId)\n                            data.push({\n                                ...x,\n                                score: x.judgeScore,\n                                RunningStep: 0,\n                                result: x.judgeResult.toString(),\n                                // sumScore: ck(x.sumScore, 100),\n                                sumScore: x.sumScore,\n                                submitTime: parseInt(x.gmtCreate),\n                            })\n                        }\n                        if (webSocketQueryList.length !== 0) {\n                            setWebSocketOpen(true)\n                            setWebSocketQueryList(webSocketQueryList)\n                        }\n                        return data\n                    }}\n                />\n            </Card>\n        </>\n    )\n}\n\n\nconst mapStateToProps = (state: any) => {\n    const TState: TableState = state.TableReduce\n    const UState: UserState = state.UserReducer\n    return {\n        tableData: TState.tableData,\n        roles: UState.userInfo?.roles\n    }\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => ({\n    addTableVersion: (name: string) => dispatch({\n        type: \"addTableVersion\",\n        name: name,\n    }),\n    setSelectedRowKeys: (data: React.Key[], name: string) =>\n        dispatch({type: \"setSelectedRowKeys\", data: data, name: name}),\n    setDataSource: (data: any, name: string) =>\n        dispatch({type: \"setDataSource\", data: data, name: name, add: true}),\n    setTopSubmission: (submissionID: string, submissionInfo: TopSubmissionInfoType) => dispatch({\n        type: \"setTopSubmission\",\n        submissionID: submissionID,\n        submissionInfo: submissionInfo\n    }),\n    setSubmissionModalVis: (data: boolean) => dispatch({type: \"setSubmissionModalVis\", data: data})\n})\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(withTranslation()(\n    withRouter(SubmissionList)\n))\n","import React, {Component, Dispatch} from \"react\";\nimport {withTranslation} from \"react-i18next\";\nimport {withRouter} from \"react-router\";\nimport {connect} from \"react-redux\";\nimport TableWithPagination from \"./TableWithPagination\";\nimport {TableState} from \"../../../Type/ITable\";\nimport {ck} from \"../../../Utils/empty\";\nimport TableWithAllData from \"./TableWithAllData\";\n\n\nclass TableWithSelection extends Component<any, any> {\n\n    componentDidMount() {\n\n    }\n\n    setSelectedRowKeys = (data: any) =>{\n        this.props.setSelectedRowKeys(data, this.props.name)\n    }\n\n    render() {\n        const selectedRowKeys = ck(this.props.tableData[this.props.name]?.selectedRowKeys, [])\n        let rowSelection: any = {\n            selectedRowKeys,\n            onChange: (selectedRowKeys: React.Key[]) => {\n                this.setSelectedRowKeys(selectedRowKeys)\n            },\n            // 多选时的下拉选项\n            selections: [\n                {\n                    key: 'all',\n                    text: this.props.t(\"selectedAll\"),\n                    onSelect: (changeableRowKeys: React.Key[]) => {\n                        let newSelectedRowKeys = changeableRowKeys\n                        newSelectedRowKeys = newSelectedRowKeys.concat(selectedRowKeys.filter((key: React.Key) => {\n                            return !changeableRowKeys.includes(key);\n                        }))\n                        this.setSelectedRowKeys(newSelectedRowKeys)\n                    },\n                },\n                {\n                    key: 'clear',\n                    text: this.props.t(\"clear\"),\n                    onSelect: (changeableRowKeys: React.Key[]) => {\n                        let newSelectedRowKeys = selectedRowKeys.filter((key: React.Key) => {\n                            return !changeableRowKeys.includes(key);\n                        })\n                        this.setSelectedRowKeys(newSelectedRowKeys)\n                    },\n                },\n                {\n                    key: 'invert',\n                    text: this.props.t(\"invert\"),\n                    onSelect: (changeableRowKeys: React.Key[]) => {\n                        let newSelectedRowKeys = changeableRowKeys.filter((key:React.Key) => {\n                            return !selectedRowKeys.includes(key);\n                        });\n                        newSelectedRowKeys = newSelectedRowKeys.concat(selectedRowKeys.filter((key: React.Key) => {\n                            return !changeableRowKeys.includes(key);\n                        }))\n                        this.setSelectedRowKeys(newSelectedRowKeys)\n                    },\n                },\n            ]\n        };\n\n        return (\n            <>\n                {this.props.uesAlldata && (\n                    <TableWithAllData\n                        {... this.props}\n                        rowSelection={this.props.disableSelection ? undefined : rowSelection}\n                    />\n                )}\n                {this.props.uesAlldata !== true && (\n                    <TableWithPagination\n                        {... this.props}\n                        rowSelection={this.props.disableSelection ? undefined : rowSelection}\n                    />\n                )}\n            </>\n        )\n    }\n}\n\nconst mapStateToProps = (state: any) => {\n    const TState: TableState = state.TableReduce\n    return {\n        tableData: TState.tableData\n    }\n\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => ({\n    setSelectedRowKeys: (data: React.Key[], name: string) =>\n        dispatch({type: \"setSelectedRowKeys\", data: data, name: name}),\n})\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(withTranslation()(\n    withRouter(TableWithSelection)\n))\n\n","import React, {Component} from \"react\";\nimport {withRouter} from \"react-router-dom\";\nimport SubmissionList from \"../../Component/submission/SubmissionList/SubmissionList\";\nimport cApi from \"../../Utils/API/c-api\";\nimport {Button} from \"antd\";\nimport {UrlPrefix} from \"../../Config/constValue\";\n\n\nclass CSubmissions extends Component<any, any> {\n\n    render() {\n        return (\n            <>\n                <div style={{textAlign: \"center\", margin: \"0 auto\"}}>\n                    <div style={{textAlign: \"left\", maxWidth: \"1500px\", margin: \"0 auto\"}}>\n                        <SubmissionList\n                            name={\"BaseSubmission\"}\n                            useForm={true}\n                            API={cApi.getSubmissionList}\n                            QuerySubmissionAPI={(submissionId: string) => {\n                                return cApi.getSubmissionInfo({submissionId: submissionId})\n                            }}\n                            problemCodeRender={(text: any) => {\n                                let ps = text.split(\"-\")\n                                return (\n                                    <Button type={\"text\"} size={\"small\"} onClick={() => {\n                                        this.props.history.push(UrlPrefix + \"/problem/\" + text)\n                                    }}>\n                                        <span style={{fontWeight: \"bold\"}}>{ps[0]}</span>-<span>{ps[1]}</span>\n                                    </Button>\n                                )\n                            }}\n                        />\n                    </div>\n                </div>\n            </>\n        );\n    }\n}\n\nexport default withRouter(CSubmissions)"],"sourceRoot":""}